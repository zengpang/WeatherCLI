const axios=require(`axios`);
const mykey=`f5c59d2df12841909d2f0ea76aaf7884`;
function getWeather(city)
{
   return new Promise((resolve,reject)=>{
    axios.get(`https://geoapi.qweather.com/v2/city/lookup?location=${encodeURI(city)}&key=${mykey}`)
    .then(response=>{
       let cityid=response.data.location[0].id;
       return cityid;
    })
    .then(cityid=>{
      let response= axios.get(`https://devapi.qweather.com/v7/weather/3d?location=${cityid}&key=${mykey}`)
      return response;  
    })
    .then(response=>{
        
        resolve(response.data);
    }
    )
    .catch(e=>{
        console.log(e);
        reject(`网络异常`);
    })
   })
}
module.exports=getWeather;